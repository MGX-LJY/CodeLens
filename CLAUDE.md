# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

CodeLens is a Document-Driven MCP (Model Context Protocol) Server designed to collaborate with Claude Code. Instead of autonomously generating documentation, CodeLens provides structured file information, document templates, and validation services that enable Claude Code to efficiently understand and document projects.

## Current State

This repository has been **successfully refactored** from an AI-driven documentation generator to a Claude Code collaboration assistant. The core MCP tools are implemented and tested.

## Core Architecture

CodeLens operates as a **Claude Code collaboration assistant** with two main service layers:

### Service Layer
- **FileService**: Project file scanning, metadata extraction, directory tree generation
- **TemplateService**: Document template management and formatting

### MCP Interface Layer
- **doc_scan**: Scans project files and returns structured information
- **template_get**: Provides document templates for various documentation levels

### Documentation Structure (When Generated by Claude Code)
1. **Architecture Layer** (`/docs/architecture/`) - System overview, design patterns, tech stack
2. **Module Layer** (`/docs/modules/`) - Module functionality, interfaces, dependencies  
3. **File Layer** (`/docs/files/`) - File summaries, classes, functions, algorithms
4. **Project Layer** (`/docs/project/`) - README, changelog, version records

## Tech Stack

- **Primary Language**: Python 3.9+
- **Framework**: MCP (Model Context Protocol)
- **File Processing**: pathlib, glob for efficient file operations
- **Template System**: String formatting with structured metadata

## MCP Tools Usage

### doc_scan
**Purpose**: Scan project files and return structured information
```python
# Command line usage
python src/mcp_tools/doc_scan.py /path/to/project --no-content

# MCP parameters
{
  "project_path": "/path/to/project",
  "include_content": true,
  "config": {
    "file_extensions": [".py"],
    "max_file_size": 50000
  }
}
```

### template_get  
**Purpose**: Retrieve document templates
```python
# Get all templates
python src/mcp_tools/template_get.py --list-all

# Get specific template
python src/mcp_tools/template_get.py --template file_summary
```



## Key Principles

- **Information Provider**: CodeLens provides structured data, Claude Code generates content
- **Template-Driven**: Standardized templates ensure consistent documentation format
- **MCP-Native**: Designed specifically for MCP protocol integration

## Current Implementation Status

✅ **Completed**:
- FileService with enhanced metadata and directory tree features
- TemplateService with 4 standard document templates
- Two MCP tools: doc_scan, template_get
- Comprehensive test suite with 100% pass rate

## File Structure (Current)

```
/src/
├── services/
│   ├── file_service.py      # Project file scanning and metadata
│   └── __init__.py
├── templates/
│   ├── document_templates.py # Template management
│   └── __init__.py  
├── mcp_tools/
│   ├── doc_scan.py         # Project scanning MCP tool
│   ├── template_get.py     # Template retrieval MCP tool
│   └── __init__.py
└── __init__.py
/docs/                      # Existing documentation structure
```

## Development Guidelines

When using CodeLens with Claude Code:

1. **Use doc_scan first**: Get project structure and file information
2. **Get templates**: Use template_get to retrieve appropriate documentation templates
3. **Generate documentation**: Let Claude Code analyze files and generate documentation using templates

## 每次都要记得把想法生成在文档中